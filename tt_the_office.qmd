---
title: "Tidy Tuesday 2020-03-17 - The Office - Words and Numbers"
date: "2023-02-27"
format: gfm
output-file: README.md
execute::echo: true
knitr::opts_chunk:
    comment: "#>"
    message: false
    error: false
    collapse: true
fig-show: true
df-print: kable
---

```{r}
library(tidyverse)

office_ratings <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-17/office_ratings.csv')

```

```{r}
office_ratings
```

**1.  Which episodes have the biggest amount of total votes and highest rating?**

```{r}
# most_votes <- 
	office_ratings |>
	select(season, title, total_votes) |>
	arrange(desc(total_votes)) |>
	head(10)

# highest_ratings <- 
	office_ratings |>
	select(season, title, imdb_rating) |>
	arrange(desc(imdb_rating)) |>
	head(10)

```

Based on these two tables, it is clear that the 3 highest rated episodes were also the ones that attracted the most engagement on IMDB from the audience (i.e., the total number of votes).

**2. What is the average rating of each season?**

```{r}
ratings_per_season <-
office_ratings |>
	group_by(season) |>
	summarise("number_of_episodes" = n_distinct(episode),
						"average_season_rating" = round(mean(imdb_rating), digits = 1)) |>
	ungroup() |>
	arrange(desc(average_season_rating))

```
Based on this data, season 3 had the highest mean rating and season 8 had the lowest. 

**3. How did the audience engagement on IMDB (total number of ratings) on changed across the seasons?

```{r}
audience_engagement <-
	office_ratings |>
	group_by(season) |>
	summarise("number_of_episodes" = n_distinct(episode),
						"average_rating_engagement" = sum(total_votes)) |>
	arrange(desc(average_rating_engagement))
```

Based on the number of IMDB ratings, season 2 collected the most ratings. 

**4. How does average season rating compare to average audience engagement on IMDB?

```{r}



```

